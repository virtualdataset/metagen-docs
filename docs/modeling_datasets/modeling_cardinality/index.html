<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Cardinality - VirtualDataSet</title>
    <meta name="generator" content="Hugo 0.31" />

    
    <meta name="description" content="VirtualDataSet Docs">
    
    <link rel="canonical" href="http://docs.virtdata.io/modeling_datasets/modeling_cardinality/">
    

    <meta property="og:url" content="http://docs.virtdata.io/modeling_datasets/modeling_cardinality/">
    <meta property="og:title" content="VirtualDataSet">
    <meta property="og:image" content="/images/virtdata_128.png">
    <meta name="apple-mobile-web-app-title" content="VirtualDataSet">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://docs.virtdata.io/images/engineblock_32.png">
    <link rel="icon" type="image/x-icon" href="http://docs.virtdata.io/images/engineblock_32.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('/fonts/icon.eot?52m981');
        src: url('/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('/fonts/icon.woff?52m981')
               format('woff'),
             url('/fonts/icon.ttf?52m981')
               format('truetype'),
             url('/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://docs.virtdata.io/stylesheets/application.css">
    <link rel="stylesheet" href="http://docs.virtdata.io/stylesheets/temporary.css">
    <link rel="stylesheet" href="http://docs.virtdata.io/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://docs.virtdata.io/stylesheets/images.css">

    <link rel="stylesheet" href="http://docs.virtdata.io/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="http://docs.virtdata.io/javascripts/modernizr.js"></script>

    

  
    

    

    
    

    
    

    
    

    
    

    
    

    
    

    
    
    <script src="http://docs.virtdata.io//modules/nomnoml/lodash.min.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/dagre.min.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/skanaar.util.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/skanaar.svg.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/skanaar.vector.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/skanaar.canvas.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/nomnoml.jison.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/nomnoml.parser.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/nomnoml.layouter.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/nomnoml.renderer.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/nomnoml.js"></script>
    
    
    
    

    
    


  </head>
  <body class="palette-primary-grey palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Cardinality
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/virtualdataset/metagen-java" title="@virtualdataset/metagen-java on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://docs.virtdata.io/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://docs.virtdata.io/images/virtdata_128.png">
        </div>
      
      <div class="name">
        <strong>VirtualDataSet </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    <span class="section">Introduction</span>
    <ul>
      
        
        



<a  title="Why VirtData?" href="http://docs.virtdata.io/why_virtdata/why_virtdata/">
	
	Why VirtData?
</a>



      
    </ul>
  
</li>



<li>
  
    <span class="section">Concepts</span>
    <ul>
      
        
        



<a  title="Mapping Functions" href="http://docs.virtdata.io/concepts/mapping_functions/">
	
	Mapping Functions
</a>



      
        
        



<a  title="Function Graphs" href="http://docs.virtdata.io/concepts/function_graphs/">
	
	Function Graphs
</a>



      
    </ul>
  
</li>



<li>
  
    <span class="section">Modeling Datasets</span>
    <ul>
      
        
        



<a  title="Cardinality" href="http://docs.virtdata.io/modeling_datasets/modeling_cardinality/">
	
	Cardinality
</a>



      
        
        



<a  title="Set Relationships" href="http://docs.virtdata.io/modeling_datasets/set_relationships/">
	
	Set Relationships
</a>



      
    </ul>
  
</li>



<li>
  
    <span class="section">Syntax Reference</span>
    <ul>
      
        
        



<a  title="Syntax Reference" href="http://docs.virtdata.io/syntax/syntax_overview/">
	
	Syntax Reference
</a>



      
    </ul>
  
</li>



<li>
  
    <span class="section">Function Reference</span>
    <ul>
      
        
        



<a  title="All Functions" href="http://docs.virtdata.io/functions/autodoc_reference/">
	
	All Functions
</a>



      
    </ul>
  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Cardinality </h1>

			

<h3 id="data-types-and-values">Data Types and Values</h3>

<p>Given that our values are all <em>bits</em> on some level, there is no basic <em>fixed
size</em> data type that has an unlimited range of values. Even the floating point
types have finite range, although it is represented and handled differently than
that of the whole number types.</p>

<h3 id="standard-types">Standard Types</h3>

<p>For a 64-bit data type, there are \( 64^2 \) different distinct values that
can be represented. With the usual twos-complement representation for signed
numbers, this ends up being every value between [-9223372036854775808,
<a href="https://en.wikipedia.org/wiki/9223372036854775807">9223372036854775807</a>],
inclusive.</p>

<p>The signed 64-bit integer is in focus here for a couple of reasons:</p>

<ul>
<li>This is the most common machine type that is used in current RNGs</li>
<li>This is the highest width type which is commonly supported throughout
modern architectures from the memory bus all the way to the registers
in the CPU.</li>
</ul>

<p>These two go hand-in-hand of course. It means that there is much to draw from in
terms of inspiration and examples for building efficient functions.</p>

<p>There will be other
<a href="https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html">types</a>
in use.  It is possible to use objects in addition to basic types, but for now
we will focus on the signed long type for the purposes of explanation.</p>

<h3 id="simulating-cardinality">Simulating Cardinality</h3>

<p>We assume that whether you are using a 64-bit <em>or</em> 32-bit signed number, that
you can represent a high enough cardinality of values to have a useful dataset,
in most cases. There are ways of having higher cardinality when needed, but they
are less efficient at runtime.</p>

<p>When applying a hash function to counting numbers, the results will generally
vary within the total range of values that you can represent.</p>

<p>For example, applying the murmur3f hash to the long values 0..3 will yield
values ranging from -8048510690352527683 to 6292367497774912474. Such large
values are not immediately useful for enumerating or simulating identifiers in
realistically bounded datasets. However, the wide dispersion achieved such a
hash function <em>is</em> useful to us, so how do we use it at a more reasonable range
of values for typical datasets?</p>

<p>Enter modulus arithmetic. With such wide ranges in values, it is reasonable to
down-sample the hashed value into the range simply by dividing the value by the
range size we want, taking only the remainder.</p>

<p>For example, the first 5 values produced by such a method with a modulo of
50 and absolute value are:</p>



<div align="center" class="nomnoml-text"><div><pre>
#zoom:0.75
#direction:right
#.input: fill=#FFFFFF visual=frame
#.function: fill=#FFFFFF visual=sender
#.userid: fill=#E2D58B visual=frame
#.firstname: fill=#44BBA4 visual=frame
[&lt;input&gt; 0] -&gt;[&lt;function&gt;Hash(0)]
[&lt;function&gt;Hash(0)] -&gt; [&lt;input&gt; 39]
[&lt;input&gt; 39] -&gt; [&lt;function&gt;Abs(39)]
[&lt;function&gt;Abs(39)] -&gt; [&lt;firstname&gt;result: 39]
[&lt;input&gt; 1] -&gt;[&lt;function&gt;Hash(1)]
[&lt;function&gt;Hash(1)] -&gt; [&lt;input&gt; 24]
[&lt;input&gt; 24] -&gt; [&lt;function&gt;Abs(24)]
[&lt;function&gt;Abs(24)] -&gt; [&lt;firstname&gt;result: 24]
[&lt;input&gt; 2] -&gt;[&lt;function&gt;Hash(2)]
[&lt;function&gt;Hash(2)] -&gt; [&lt;input&gt; -43]
[&lt;input&gt; -43] -&gt; [&lt;function&gt;Abs(-43)]
[&lt;function&gt;Abs(-43)] -&gt; [&lt;firstname&gt;result: 43]
[&lt;input&gt; 3] -&gt;[&lt;function&gt;Hash(3)]
[&lt;function&gt;Hash(3)] -&gt; [&lt;input&gt; -33]
[&lt;input&gt; -33] -&gt; [&lt;function&gt;Abs(-33)]
[&lt;function&gt;Abs(-33)] -&gt; [&lt;firstname&gt;result: 33]
[&lt;input&gt; 4] -&gt;[&lt;function&gt;Hash(4)]
[&lt;function&gt;Hash(4)] -&gt; [&lt;input&gt; 21]
[&lt;input&gt; 21] -&gt; [&lt;function&gt;Abs(21)]
[&lt;function&gt;Abs(21)] -&gt; [&lt;firstname&gt;result: 21]
</pre></div></div>
<script type="text/javascript" src="http://docs.virtdata.io/modules/nomnoml/inithook-nomnoml.js"></script>


<p>We use absolute value in addition to modulo, because signed results allow our
range to span twice as many unique values as our intended output range.</p>

<p>The next five values are 0, 6, 22, 6, and 2.</p>

<p>This shows that we have a single duplicate (6), which is quite expected,
according to the odds. In fact, the probability of seeing a single duplicate
goes over 50% as you go to 9 samples. Over very large numbers of samples, the
effect evens out quite well. In fact, it is easy to show that the quality of
samples produced in this way is directly dependent upon the quality of the
underlying hash function as one would expect.</p>

<p>Using this method, we are able to simulate very large ranges and very large
numbers of data samples. Furthermore, since the function pipeline is purely
functional with no mutable state, we know that we can use the mapping from the
input value to the output as a map that does not change. In other words, if we
take the input value as an enumeration of samples, or <em>coordinates</em> of the
output data, we have a fixed dataset with respect to the samples we choose to
observe. In this sense, applying the function is akin to taking samples of data
from a fixed coordinate space.</p>

<h3 id="to-be-continued">To Be Continued&hellip;</h3>

<p>There is more to come on this section in the future. Stay tuned.</p>


			<aside class="copyright" role="note">
				
				&copy; 2018 APL 2.0 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://docs.virtdata.io/syntax/syntax_overview/" title="Syntax Reference">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Syntax Reference
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://docs.virtdata.io/modeling_datasets/set_relationships/" title="Set Relationships">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Set Relationships
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="http://docs.virtdata.io/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "Â¶";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

