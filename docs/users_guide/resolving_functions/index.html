<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Function Flows - VirtualDataSet</title>
    <meta name="generator" content="Hugo 0.46" />

    
    <meta name="description" content="VirtualDataSet Docs">
    
    <link rel="canonical" href="http://docs.virtdata.io/users_guide/resolving_functions/">
    

    <meta property="og:url" content="http://docs.virtdata.io/users_guide/resolving_functions/">
    <meta property="og:title" content="VirtualDataSet">
    <meta property="og:image" content="/images/virtdata_128.png">
    <meta name="apple-mobile-web-app-title" content="VirtualDataSet">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="../../images/engineblock_32.png">
    <link rel="icon" type="image/x-icon" href="../../images/engineblock_32.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('/fonts/icon.eot?52m981');
        src: url('/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('/fonts/icon.woff?52m981')
               format('woff'),
             url('/fonts/icon.ttf?52m981')
               format('truetype'),
             url('/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="../../stylesheets/application.css">
    <link rel="stylesheet" href="../../stylesheets/temporary.css">
    <link rel="stylesheet" href="../../stylesheets/palettes.css">
    <link rel="stylesheet" href="../../stylesheets/images.css">

    <link rel="stylesheet" href="../../stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="../../javascripts/modernizr.js"></script>

    

  

    
    

    
    

    
    

    
    
    <script src="http://docs.virtdata.io//modules/jssequence/webfont.js"></script>
    <script src="http://docs.virtdata.io//modules/jssequence/snap.svg-min.js"></script>
    <script src="http://docs.virtdata.io//modules/jssequence/underscore-min.js"></script>
    <script src="http://docs.virtdata.io//modules/jssequence/sequence-diagram.js"></script>
    <link href="http://docs.virtdata.io//modules/jssequence/sequence-diagram-min.css" rel="stylesheet" />
    

    
    
    <script src="http://docs.virtdata.io//modules/railroad/railroad-diagrams.js"></script>
    <link href="http://docs.virtdata.io//modules/railroad/railroad-diagrams.css" rel="stylesheet">
    

    
    
    <link href="http://docs.virtdata.io//modules/jsxgraph/jsxgraph.css" type="text/css" rel="stylesheet"/>
    <script src="http://docs.virtdata.io//modules/jsxgraph//jsxgraphcore.js"></script>
    
    

    
    
    <link href="http://docs.virtdata.io//modules/mermaid/mermaid.css" type="text/css" rel="stylesheet"/>
    <script src="http://docs.virtdata.io//modules/mermaid/mermaid.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    

    
    
    <script src="http://docs.virtdata.io//modules/nomnoml/lodash.min.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/dagre.min.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/skanaar.util.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/skanaar.svg.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/skanaar.vector.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/skanaar.canvas.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/nomnoml.jison.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/nomnoml.parser.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/nomnoml.layouter.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/nomnoml.renderer.js"></script>
    <script src="http://docs.virtdata.io//modules/nomnoml/nomnoml.js"></script>
    

    
    

    
    


  </head>
  <body class="palette-primary-grey palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Function Flows
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/virtualdataset/metagen-java" title="@virtualdataset/metagen-java on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://docs.virtdata.io/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://docs.virtdata.io/images/virtdata_128.png">
        </div>
      
      <div class="name">
        <strong>VirtualDataSet </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    <span class="section">Introduction</span>
    <ul>
      
        
        



<a  title="Why VirtData?" href="../../why_virtdata/why_virtdata/">
	
	Why VirtData?
</a>





      
    </ul>
  
</li>



<li>
  
    <span class="section">Concepts</span>
    <ul>
      
        
        



<a  title="Mapping Functions" href="../../concepts/mapping_functions/">
	
	Mapping Functions
</a>





      
        
        



<a  title="Function Graphs" href="../../concepts/function_graphs/">
	
	Function Graphs
</a>





      
        
        



<a  title="Modeling Cardinality" href="../../concepts/modeling_cardinality/">
	
	Modeling Cardinality
</a>





      
        
        



<a  title="Modeling Set Relationships" href="../../concepts/set_relationships/">
	
	Modeling Set Relationships
</a>





      
    </ul>
  
</li>



<li>
  
    <span class="section">Using VirtData</span>
    <ul>
      
        
        



<a  title="Function Flows" href="../../users_guide/resolving_functions/">
	
	Function Flows
</a>





      
        
        



<a  title="VirtData Syntax" href="../../users_guide/syntax_overview/">
	
	VirtData Syntax
</a>





      
    </ul>
  
</li>



<li>
  
    <span class="section">Function Reference</span>
    <ul>
      
        
        



<a  title="collections" href="../../functions/funcref_collections/">
	
	collections
</a>





      
        
        



<a  title="conversion" href="../../functions/funcref_conversion/">
	
	conversion
</a>





      
        
        



<a  title="datetime" href="../../functions/funcref_datetime/">
	
	datetime
</a>





      
        
        



<a  title="diagnostics" href="../../functions/funcref_diagnostics/">
	
	diagnostics
</a>





      
        
        



<a  title="distributions" href="../../functions/funcref_distributions/">
	
	distributions
</a>





      
        
        



<a  title="general" href="../../functions/funcref_general/">
	
	general
</a>





      
        
        



<a  title="premade" href="../../functions/funcref_premade/">
	
	premade
</a>





      
        
        



<a  title="state" href="../../functions/funcref_state/">
	
	state
</a>





      
    </ul>
  
</li>



<li>
  
    <span class="section">Site Info</span>
    <ul>
      
        
        



<a  title="Typography" href="../../siteinfo/typography/">
	
	Typography
</a>





      
    </ul>
  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Function Flows </h1>

			

<p>When using VirtData to craft procedural data generation
recipes, you can combine multiple functions in a chain,
as described in <code>Composition and Dataflow</code> in
<a href="../function_graphs/">../function_graphs</a>.</p>

<p>This section explains how the library finds and selects
specific functions before composing them together in
a lambda. It also explains how to read the detailed
documentation as described in the function reference
section.</p>

<h2 id="function-signatures">Function Signatures</h2>

<p>There are several parts to a typical function signature in
VirtData.</p>

<ul>
<li>The input type</li>
<li>The function name</li>
<li>Zero or more initializer parameters of a specific type</li>
<li>The output type</li>
</ul>

<p>In the reference section, this may appear as:</p>

<pre><code>int -&gt; Add(int: addend) -&gt; int
====== === ==== ======  ======
^      ^   ^    ^          ^
|      |   |    |          |
|      |   |    |          + an output type
|      |   |    + an initializer parameter name
|      |   + an initializer parameter type
|      +- the function name
+-- an input type

</code></pre>

<p>While each specific function provided in the library
has all of the above details, it is not always convenient
to refer to them with the full description as shown.</p>

<p>In practical use, an <em>Add</em> function could be called upon
using any of these forms:</p>

<pre><code># no input our output type qualifiers, just an intializer parameter:
Add(5)

# fully qualified input and output types:
int -&gt; Add(5) -&gt; int

# partially qualified input or output types:
Add(5) -&gt; int
int -&gt; Add(5)

</code></pre>

<p>The name <code>Add(...)</code> refers not just a single
function, but four different functions in the library:</p>

<ul>
<li><code>double -&gt; Add(double: addend) -&gt; double</code></li>
<li><code>long -&gt; Add(long: addend) -&gt; int</code></li>
<li><code>long -&gt; Add(long: addend) -&gt; long</code></li>
<li><code>int -&gt; Add(int: addend) -&gt; int</code></li>
</ul>

<p>These functions are separate and distinct, but they share
a name and a common purpose. This is why you can use
only the name when using these functions in practice.
Specifically, <strong>the input and output types are optional
when referring to functions</strong>.</p>

<h2 id="function-initializers">Function Initializers</h2>

<p>When you see the the example function <code>Add(5)</code>, the single
parameter <code>5</code> is an initializer parameter to the function.
This means that it is part of the function definition.
All functions in VirtData are intended to be pure functions
&ndash; once they are initialized, they will return the same output
value for any specific input value no matter how many times
or in what order the input values are applied to the function.</p>

<p>The term <em>function initializer</em> is meant to emphasize that
the values you use in function definitions are <strong>not</strong> the
values applied to the function. You don&rsquo;t specify the values
which will be applied to the function where you define them.
The functions are defined separately from where they are used,
and all values that are provided in the function definitions are
merely function <em>initializer</em> parameters.</p>

<p>This is another way of saying, for example, that &ldquo;add 5&rdquo; is
conceptually a function definition, while &ldquo;add 5 to x&rdquo; is the
application of a function to an input <em>x</em>. The variable <em>x</em> is
never mentioned in the function definition, and the value <em>5</em>
as a parameter ot the function&rsquo;s construction is an essential
part of the function itself, not the variables that the function
is applied to. This might seem obvious, but it is worth stating
explicitly here, since any ambiguity on this topic could lead
to confusion.</p>

<h2 id="finding-functions">Finding Functions</h2>

<p>When you use the specifier <code>int -&gt; Add(5) -&gt; int</code>, the
input and output type qualifiers limit the library to
considering <em>only</em> the matching functions. This is limited
to only the fourth function in the list above. If you
only use <code>Add(5)</code> with no input or output qualifiers,
all four functions are considered.</p>

<h3 id="java-object-types">Java Object Types</h3>

<p>If you use an output qualifier like <code>-&gt; java.util.Date</code>, then
VirtData will use this specific type to avoid considering
any function that does not have the specified input
or output type. This must be a canonical class name that
can be used to resolve the class at runtime.</p>

<h2 id="function-candidates">Function Candidates</h2>

<p>So what when you create a function chain like <code>Add(5); Mul(15)</code>?
Each contributing function specifier can refer to one ore more
candidate functions. With this basic description of a VirtData flow,
the following list of candidates is constructed:</p>



<div align="middle" class="nomnoml-text"><div><pre>
#zoom:0.75
#direction:right
#.value: fill=#D0FFD0 visual=frame
#.function: fill=#E0FFE0 visual=sender
[&lt;value&gt;long] -&gt; [&lt;function&gt;int-&gt;Add(5)-&gt;int]
[&lt;value&gt;long] -&gt; [&lt;function&gt;long-&gt;Add(5)-&gt;int]
[&lt;value&gt;long] -&gt; [&lt;function&gt;long-&gt;Add(5)-&gt;long]
[&lt;function&gt;int-&gt;Add(5)-&gt;int] -&gt; [??]
[&lt;function&gt;long-&gt;Add(5)-&gt;int] -&gt; [??]
[&lt;function&gt;long-&gt;Add(5)-&gt;long] -&gt; [??]
[??] -&gt; [int-&gt;Mul(15)-&gt;int]
[??] -&gt; [long-&gt;Mul(15L)-&gt;int]
[??] -&gt; [long-&gt;Mul(15L)-&gt;long]
[int-&gt;Mul(15)-&gt;int] -&gt; [???]
[long-&gt;Mul(15L)-&gt;int] -&gt; [???]
[long-&gt;Mul(15L)-&gt;long] -&gt; [???]
</pre></div></div>
<script type="text/javascript" src="../../modules/nomnoml/inithook-nomnoml.js"></script>


<p>This represents the two sets of functions that could
possibly be used to construct a chain of single functions.</p>

<p>The output type is not known in this case, since there was no
trailing output type qualifier, and is represented by <code>???</code>.
The intermediate type is not known yet, and is represented by <code>??</code>.
By default, the required input type is always set to <code>long</code> if no
other is specified.</p>

<h2 id="function-reduction">Function Reduction</h2>

<p>VirtData uses a set of reduction rules to narrow
down the list to only one per function per position.
Starting at the output side of a flow, the following
rules are applied to functions in order to reduce
the candidates down to one function per stage.</p>

<ol>
<li>Functions in the last set must have an output
which is compatible with the required output type
of the whole function flow.</li>
<li>Downstream functions must have an input type
that matches at least one of the output types
of upstream functions.</li>
<li>Downstream functions must have an input type
that is assignable from at least one of the output
types of upstream functions, <strong>without autoboxing</strong>.</li>
<li>Downstream functions must have an input type
that is assignable from at least one of the output
types of upstream functions, <strong>with autoboxing</strong>.</li>
<li>The input type of a function must be the most
preferred type with precedence of long, int, float,
double, boolean, byte, String, Object.
<br /></li>
</ol>

<p>In any case where a reduction rule would remove
<em>all</em> functions for a stage, that reduction is skipped.
If any reduction is possible, then the process starts
again at the top.</p>

<p>Given this schematic above, it is possible to map 6 pathways through the
functions, yielding 6 possible lambdas. In this case, the rules
explained above will reduce the function candidates to the
final chain of functions, containing only one remaining function per position:</p>



<div align="middle" class="nomnoml-text"><div><pre>
#zoom:0.75
#direction:right
#.value: fill=#D0FFD0 visual=frame
#.function: fill=#E0FFE0 visual=sender
[&lt;function&gt;long-&gt;Add(5)-&gt;long] -&gt; [&lt;function&gt;long-&gt;Mul(15L)-&gt;long]
</pre></div></div>
<script type="text/javascript" src="../../modules/nomnoml/inithook-nomnoml.js"></script>


<h2 id="function-compositing">Function Compositing</h2>

<p>The result of function reduction is passed to a lambda construction facility
within VirtData known as the function compositor. The compositor builds a
proper lambda in the Java runtime, yielding a final single function at runtime
that &ldquo;adds 5 and then multiplies the result by 15&rdquo;.</p>

<p>If the types of the remaining functions are not
directly compatible according to Java casting and conversion rules, the
function compositor will make a best-effort conversion in order to combine
functions in a flexible way. Flows which must rely on this capability are
not as performant as those which have good type alignment in between
function stages. Consult the function library reference on the available
types and conversions if you want to keep things fast.</p>


			<aside class="copyright" role="note">
				
				&copy; 2018 APL 2.0 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
  </div>

  <div class="next">
  
      <a href="http://docs.virtdata.io/users_guide/syntax_overview/" title="VirtData Syntax">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              VirtData Syntax
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="../../javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "¶";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

